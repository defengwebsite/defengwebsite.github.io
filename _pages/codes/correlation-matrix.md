---
layout: single
title: "Codes for nearest (covariance) correlation matrix problems"
permalink: /Codes/correlation-matrix/
author_profile: true
---
- Codes for the Nearest Correlation Matrix problem (the problem was initially introduced by Prof. [Nick Higham](https://www.maths.manchester.ac.uk/~higham/)):  <a href="../files/CorrelationMatrix.m" download>CorrelationMatrix.m</a> is a Matlab code written for computing the nearest correlation matrix problem (first uploaded in August 2006; last updated on August 30, 2019). This code should be good enough for most Matlab users.  If your Matlab version is very low and you really need a faster code, you can download <a href="../files/mexeig.mexw64" download>mexeig.mexw64</a> (for win64 operating system) and if use win32 or Linux system, you need to download the installmex file <a href="../files/installmex.m" download>installmex.m</a> and the c-file <a href="../files/mexeig.c" download>mexeig.c</a> by running the installmex.m first. For a randomly generated  <span style="color:blue">3,000 by 3,000</span> pseudo correlation matrix (the code is insensitive to input data), the code needs <span style="color:red">24</span> seconds to reach a solution with the relative duality gap less than 1.0e-3 after 3 iterations and 43 seconds  with the relative duality gap less than 1.0e-10 after 6 iterations in my Dell Desktop with Intel (R) Core i7 processor and for an invalid <span style="color:red">10,000 by 10,000</span> pseudo correlation matrix, the code needs 15 minutes to reach a solution with the relative duality gap less than 1.0e-4 after 4 iterations and 24 minutes with the relative duality gap less than 1.0e-12 after 7 iterations. For practitioners, you may set the stopping criterion (relative duality gap) to stay between 1.0e-1 and 1.0e-3 to run the code (typically, 1 to 3 iterations). If you need a C/C++ code, download <a href="../files/main.c" download>main.c</a> and <a href="../files/main.h" download>main.h</a>, which were written by [Pawel Zaczkowski](https://www.linkedin.com/in/pawel-zaczkowski-13a6a233/?originalSubdomain=uk) under a summer research project. If you are a client to [The Numerical Algorithms Group](https://nag.com/) (NAG), you may also enjoy [their commercialized implementations](https://nag.com/IndustryArticles/Nearest_Correlation_Matrix.pdf). The code in R <a href="../files/CorrelationMatrix.R" download>CorrelationMatrix.R</a> was written by [Ying Cui](https://sites.google.com/site/optyingcui/) (last updated on August 31, 2019; for efficiency, please use [Microsoft R open](https://mran.microsoft.com/open)) and the code in Python <a href="../files/CorrelationMatrix.py" download>CorrelationMatrix.py</a> was written by [Yancheng Yuan](https://www.polyu.edu.hk/ama/people/academic-staff/dr-yuan-yancheng/?sc_lang=en) (last updated on May 11, 2017), <span style="color:blue">respectively.</span>